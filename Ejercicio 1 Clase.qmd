---
title: "Ejercicio 1 Clase"
author: "Equipo"
format: html
editor: visual
---

```{r}
#| warning: false
library(tidyverse) # data science
library(fpp3) # ts
library(plotly) # interactive plots
library(patchwork) # handling many plots in one figure
library(tidyquant)
```

# Ejercicio 1
1: Tomando el PIB de cada país, GDP, contenido en la tabla global_economy, grafique el PIB per cápita a lo largo del tiempo. ¿Cómo ha sido la evolución de la economía de los países en el tiempo? ¿Cuál país tiene el mayor PIB per cápita? (Les recomiendo quitar la leyenda del gráfico, incluyendo theme(legend.position = "none"))


```{r}
global <- global_economy |> 
  mutate('GDP_per_capita' = GDP/Population)
global
```

```{r}
p <- global |> 
  autoplot(GDP_per_capita) + theme(legend.position = "none") + ggtitle("PIB per cápita por país")
ggplotly(p, dynamicTicks = TRUE)
```

```{r}
global |> 
  select(c(Country,Year,GDP_per_capita)) |> 
  filter(Year == 2016) |> 
  arrange(desc(GDP_per_capita))
```

```{r}
#global_economy |> 
 # mutate(gdp_per_capita=GDP/Population) |> 
  #select(-c(Code,Growth:Exports)) |> 
  #filter(Year %in% 2010:2017) |> 
  #as_tsibble() |> 
  #group_by(Country) |> 
  #summarise(mean_gdpp = mean (gd_per_capita, na.rm = TRUE)) |> 
  
```


### ¿Cómo ha sido la evolución de la economía de los países en el tiempo?*

La gran mayoría de países muestra un crecimiento de su PIB per cápita a lo largo del tiempo. Se puede ver una tendencia similar entre todos los países en cuanto a los años en los que sube el PIB per cápita y años en los que baja de manera general como en 2008 por la crisis inmobiliaria de Estados Unidos. Que los movimientos en el PIB per cápita sean similares entre tantos paíes se debe principalmente a lo globalizada que esta la economía actualmente.

### ¿Cuál país tiene el mayor PIB per cápita?*

Monaco es el país con un mayor PIB per cápita de $168,010 por persona.

# Ejercicio 2

Grafique las siguientes series de tiempo y transfórmelas y/o ajústelas si lo considera necesario. ¿Qué efecto tuvo la transformación?

## PIB de EEUU, de global_economy.

```{r}
eua <- global |> 
  filter(Country == "United States")
eua |> 
  autoplot(GDP)
eua |> 
  autoplot(log(GDP)) + ggtitle("Transformación Logarítmica")
eua |> 
  autoplot(GDP_per_capita) + ggtitle("Transformación por población")
```


## PIB de México, también de global_economy.

```{r}
mex <- global |> 
  filter(Country == "Mexico")
mex |> 
  autoplot(GDP)
mex |> 
  autoplot(log(GDP)) + ggtitle("Transformación Logarítmica")
mex |> 
  autoplot(GDP_per_capita) + ggtitle("Transformación por población")
```

## Demanda de electricidad en el estado de Victoria (Australia), de vic_elec.

```{r}
vic_elec |> 
  autoplot(Demand)
vic_elec |> 
  autoplot(log(Demand)) + ggtitle("Transformación Logarítmica")
```

### ¿Qué efecto tuvo la transformación?

* EUA: 
* México:
*Victoria:

# Ejercicio 3

¿Es útil realizar una transformación de Box-Cox a los datos canadian_gas? ¿Por qué sí o por qué no?

```{r}
cg <- canadian_gas |> 
  autoplot(Volume) + ggtitle("Volumen de Gas")
ggplotly(cg, dynamicTicks = TRUE)
```

```{r}
(lambda <- canadian_gas |> 
  features(Volume, features = guerrero) |> 
  pull(lambda_guerrero))
```

```{r}
canadian_gas |> 
  autoplot(box_cox(Volume, lambda)) + ggtitle("Box-Cox, lambda = 0.5767648")
```


```{r}

p5 <- canadian_gas |>  autoplot(box_cox(Volume,lambda = 0.5767648)) + ggtitle("Box-Cox, lambda = 0.5767648")

p5

```





# Ejercicio 4

El dataset fma::plastics tiene información de las ventas mensuales (medidas en miles) del producto A para un productor de plásticos, a lo largo de cinco años.

Grafique la serie de tiempo para el producto A. ¿Identifica algún componente de tendencia-ciclo y/o estacional?
Utilice una descomposición clásica multiplicativa para calcular el componente de tendencia y estacional.
¿Los resultados coinciden con su respuesta al inciso i)?
Calcule y grafique los datos desestacionalizados.
Cambie, manualmente, una observación para que sea un outlier (p. ej., sume 500 a una observación). Vuelva a estimar los datos desestacionalizados. ¿Cuál fue el efecto de ese outlier?
¿Hace alguna diferencia que el outlier se encuentre cerca del final de la serie o más alrededor del centro?
